<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fnx" uri="http://java.sun.com/jsp/jstl/functionsx" %>
<%@ taglib prefix="s" uri="http://www.springframework.org/tags" %>
<%@ taglib prefix="f" uri="http://www.hacms.com/tags/form" %>
<%@ taglib prefix="shiro" uri="http://shiro.apache.org/tags" %>
<%@ taglib prefix="tags" tagdir="/WEB-INF/tags" %>
<!DOCTYPE html>
<html>
<head>
    <jsp:include page="/WEB-INF/views/head.jsp" />
    <script src="${ctx}/static/js/distpicker.data.js"></script>
    <script src="${ctx}/static/js/distpicker.js"></script>
    <script>

        $(function () {
            initNations();

        })

        //初始化民族
        var nations = [ "蒙古族","汉族", "回族", "藏族", "维吾尔族", "苗族", "彝族", "壮族", "布依族", "朝鲜族", "满族", "侗族", "瑶族", "白族", "土家族","哈尼族", "哈萨克族", "傣族", "黎族", "傈僳族", "佤族", "畲族", "高山族", "拉祜族", "水族", "东乡族", "纳西族", "景颇族", "柯尔克孜族","土族", "达斡尔族", "仫佬族", "羌族", "布朗族", "撒拉族", "毛南族", "仡佬族", "锡伯族", "阿昌族", "普米族", "塔吉克族", "怒族", "乌孜别克族","俄罗斯族", "鄂温克族", "德昂族", "保安族", "裕固族", "京族", "塔塔尔族", "独龙族", "鄂伦春族", "赫哲族", "门巴族", "珞巴族", "基诺族"];
        function initNations() {

            var staff_nation = document.getElementById("minzu");
            for (var i in nations) {
                staff_nation.add(new Option(nations[i], nations[i]));
            }
        }
        $(function () {
            $("#validForm").validate();
            $("input[name='username']").focus();
        });

        function confirmDelete() {
            return confirm("<s:message code='confirmDelete'/>");
        }

        function singleDelete(id) {
            if (!confirmDelete()) return false;
            $('#singleIds').val(id);
            $('#singleForm').attr('action', 'delete.do').submit();
        }




    </script>
</head>
<body class="skin-blue content-body">
<jsp:include page="/WEB-INF/views/commons/show_message.jsp" />
<form id="singleForm" method="post">
    <tags:search_params />
    <input type="hidden" id="singleIds" name="ids" value="">
</form>
<div class="content-header">
    <h1><s:message code="user.management" /> - <s:message code="${oprt=='edit' ? 'edit' : 'create'}" /></h1>
</div>
<c:set var="usernameExist"><s:message code="user.username.exist" /></c:set>
<div class="content">
    <div class="box box-primary">
                                  <!--头像开始-->
                                  <form method="post" id="userImage" enctype="multipart/form-data">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group">
                                                <div style="text-align: center; padding: 20px;margin-left: 10%;">
                                                    <img id="headImg" style="height: 140px;width: 140px;" src="${user.avatarLarge}"
                                                        class="img-circle">
                                                    <div style="padding-top:30px;">
                                                        <span onclick="selectImg()" class="btn btn-default" style="border-color: #6c9b88;color:#6c9b88;">上传头像</span>
                                                        <input type="file" name="file" id="uploadImg" accept=".gif,.jpg,.png,.jpeg" style="display: none" onchange="handleImg()">
                                                        <button id="imgBtn" type="button" class="btn btn-danger btn-lg" onclick="saveImg()" style="display: none;">保存</button>
                                                    </div>
                                                    <f:hidden id='userid' name="userid" value="${bean.id}" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                 <!--头像结束-->
        <form class="form-horizontal" id="validForm" action="${oprt=='edit' ? 'update' : 'save'}.do" method="post">
            <tags:search_params />
            <f:hidden name="oid" value="${bean.id}" />
            <f:hidden name="position" value="${position}" />
            <input type="hidden" id="redirect" name="redirect" value="edit" />
            <div class="box-header with-border">
                <div class="btn-toolbar">
                    <div class="btn-group">
                        <shiro:hasPermission name="core:user:create">
                            <button class="btn btn-default" type="button" onclick="location.href='create.do?orgId=${org.id}&${searchstring}';"<c:if test="${oprt=='create'}"> disabled="disabled"</c:if>><s:message code="create" /></button>
                        </shiro:hasPermission>
                        <shiro:hasPermission name="core:user:copy">
                            <button class="btn btn-default" type="button" onclick="location.href='create.do?id=${bean.id}&${searchstring}';"<c:if test="${oprt=='create'}"> disabled="disabled"</c:if>><s:message code="copy" /></button>
                        </shiro:hasPermission>
                    </div>
                    <div class="btn-group">
                        <shiro:hasPermission name="core:user:delete">
                            <button class="btn btn-default" type="button" onclick="singleDelete(${bean.id})"<c:if test="${oprt=='create' || bean.id le 1}"> disabled="disabled"</c:if>><s:message code="delete" /></button>
                        </shiro:hasPermission>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-default" type="button" onclick="location.href='edit.do?id=${side.prev.id}&position=${position-1}&${searchstring}';"<c:if test="${empty side.prev}"> disabled="disabled"</c:if>><s:message code="prev" /></button>
                        <button class="btn btn-default" type="button" onclick="location.href='edit.do?id=${side.next.id}&position=${position+1}&${searchstring}';"<c:if test="${empty side.next}"> disabled="disabled"</c:if>><s:message code="next" /></button>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-default" type="button" onclick="location.href='list.do?${searchstring}';"><s:message code="return" /></button>
                    </div>
                </div>
            </div>
            <div class="box-body">
            	<c:if test="${oprt=='edit'}">
                 </c:if>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="col-sm-4 control-label"><em class="required">*</em><s:message code="user.org" /></label>
                            <div class="col-sm-8">
                                <f:hidden id="orgId" name="orgId" value="${org.id}" />
                                <f:hidden id="orgIdNumber" value="${org.id}" />
                                <div class="input-group">
                                    <f:text id="orgIdName" value="${org.displayName}" class="form-control required" readonly="readonly" />
                                    <span class="input-group-btn">
										<button class="btn btn-default" id="orgIdButton" type="button"><s:message code='choose' /></button>
									</span>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        Cms.f7.org("orgId", "orgIdName", {
                                            settings: {"title": "<s:message code='org.f7.selectOrg'/>"},
                                            params: {"allowRoot": "false", "treeNumber": "${orgTreeNumber}"}
                                        });
                                    });
                                </script>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="orgIdsNameDisplay" class="col-sm-4 control-label"><s:message code="user.orgs" /></label>
                            <div class="col-sm-8">
                                <div id="orgIds">
                                    <c:set var="orgs" value="${bean.orgsExcludeMain}" />
                                    <c:forEach var="n" items="${orgs}">
                                        <f:hidden name="orgIds" value="${n.id}" />
                                    </c:forEach>
                                </div>
                                <div id="orgIdsNumber">
                                    <c:forEach var="n" items="${orgs}">
                                        <f:hidden name="orgIdsNumber" value="${n.id}" />
                                    </c:forEach>
                                </div>
                                <div id="orgIdsName">
                                    <c:forEach var="n" items="${orgs}">
                                        <f:hidden name="orgIdsName" value="${n.displayName}" />
                                    </c:forEach>
                                </div>
                                <div class="input-group">
                                    <f:text class="form-control" id="orgIdsNameDisplay" readonly="readonly" />
                                    <span class="input-group-btn">
										<button class="btn btn-default" id="orgIdsButton" type="button"><s:message code='choose' /></button>
									</span>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        Cms.f7.orgMulti("orgIds", {
                                            settings: {"title": "<s:message code='user.pleaseSelectOrgs'/>"},
                                            params: {"treeNumber": "${orgTreeNumber}"}
                                        });
                                    });
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="username" class="col-sm-4 control-label"><em class="required">*</em><s:message code="user.username" /></label>
                            <div class="col-sm-8">
                                <f:text id="username" name="username" value="${oprt=='edit' ? (bean.username) : ''}"
                                        class="form-control {required:true,remote:{url:'check_username.do',type:'post',data:{original:'${oprt=='edit' ? (bean.username) : ''}'}},messages:{remote:'${usernameExist}'}}" />
                            	<f:hidden id="userSkin" name="userSkin" value="${oprt=='edit' ? (bean.userSkin) : 'blue'}"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="realName" class="col-sm-4 control-label"><em class="required">*</em><s:message code="user.realName" /></label>
                            <div class="col-sm-8">
                                <f:text class="form-control required" id="realName" name="realName" value="${bean.realName}" maxlength="100" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="rawPassword" class="col-sm-4 control-label"><em class="required">*</em><s:message code="user.password" /></label>
                            <div class="col-sm-8">
                                <input class="form-control" id="rawPassword" type="password" name="rawPassword" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="againPassword" class="col-sm-4 control-label"><em class="required">*</em><s:message code="user.pwdAgain" /></label>
                            <div class="col-sm-8">
                                <input id="againPassword" type="password" name="againPassword" class="form-control {equalTo:'#rawPassword'}" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="form-group">
                            <label for="type" class="col-sm-2 control-label">
                                <s:message code="user.roles" />
                                <span class="in-prompt" title="<s:message code='user.roles.prompt' htmlEscape='true'/>"></span>
                            </label>
                            <div class="col-sm-10 form-inline">
                                <select class="form-control" id="type" name="type" onchange="$('#roles').toggle($('#type').val()==1);$('#roles input').each(function(){$(this).prop('disabled',$('#type').val()==0||$(this).attr('data-disabled')=='true')});">
                                    <f:option value="0" selected="${bean.type}"><s:message code="user.type.0" /></f:option>
                                    <f:option value="1" selected="${bean.type}" default="1"><s:message code="user.type.1" /></f:option>
                                </select> &nbsp;
                                <span id="roles"<c:if test="${!empty bean.type && bean.type==0}"> style="display:none;"</c:if>>
					    		<c:forEach var="role" items="${roleList}">
                                    <label class="checkbox-inline"<c:if test="${role.rank < bean.rank}"> style="color:#bbb;"</c:if>><input type="checkbox" name="roleIds" value="${role.id}"<c:if test="${fnx:contains_cso(bean.roles,'id',role.id)}"> checked="checked"</c:if><c:if
                                            test="${role.rank < bean.rank}"> disabled data-disabled="true"</c:if> />${role.name}(${role.rank})</label>
                                </c:forEach>
					    	</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="groupId" class="col-sm-4 control-label"><s:message code="user.group" /></label>
                            <div class="col-sm-8">
                                <select class="form-control" id="groupId" name="groupId">
                                    <f:options items="${groupList}" selected="${bean.group.id}" itemLabel="name" itemValue="id" />
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="status" class="col-sm-4 control-label"><s:message code="user.status" /></label>
                            <div class="col-sm-8">
                                <select class="form-control" id="status" name="status">
                                    <f:option value="0" selected="${bean.status}" default="0"><s:message code='user.status.0' /></f:option>
                                    <f:option value="1" selected="${bean.status}"><s:message code='user.status.1' /></f:option>
                                    <f:option value="2" selected="${bean.status}"><s:message code='user.status.2' /></f:option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="form-group">
                            <label class="col-sm-2 control-label"><s:message code="user.groups" /></label>
                            <div class="col-sm-10">
                                <f:checkboxes labelClass="checkbox-inline" name="groupIds" items="${groupList}" checked="${bean.groupsExcludeMain}" itemLabel="name" itemValue="id" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="rank" class="col-sm-4 control-label">
                                <s:message code="user.rank" />
                                <span class="in-prompt" title="<s:message code='user.rank.prompt' htmlEscape='true'/>"></span>
                            </label>
                            <div class="col-sm-8">
                                <f:text id="rank" name="rank" value="${(empty bean.rank) ? (currRank+1) : (bean.rank)}" class="form-control {digits:true,min:${currRank},max:2147483647}" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="col-sm-4 control-label"><s:message code="user.gender" /></label>
                            <div class="col-sm-8">
                                <label class="radio-inline"><f:radio name="gender" value="M" checked="${bean.gender}" default="M" class="required"/><s:message code="male" /></label>
                                <label class="radio-inline"><f:radio name="gender" value="F" checked="${bean.gender}" class="required"/><s:message code="female" /></label>
                                <%--<label class="radio-inline"><f:radio name="gender" checked="${bean.gender}" default="" /><s:message code="secret" /></label>--%>
                            </div>
                        </div>
                    </div>
                </div>





                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="sixianggugan" class="col-sm-4 control-label">思想骨干</label>
                            <div class="col-sm-8">
                                <label class="radio-inline"><f:radio name="sixianggugan" value="0" checked="${bean.sixianggugan}" default="0" class="required" />否</label>
                                <label class="radio-inline"><f:radio name="sixianggugan" value="1" checked="${bean.sixianggugan}"   class="required"/>是</label>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="lamor" class="col-sm-4 control-label">劳模</label>
                            <div class="col-sm-8">
                                <label class="radio-inline"><f:radio name="lamor" value="0" checked="${bean.lamor}" default="0" class="required"/>否</label>
                                <label class="radio-inline"><f:radio name="lamor" value="1" checked="${bean.lamor}"  class="required"/>是</label>
                            </div>
                        </div>
                    </div>
                    <%--<div class="col-sm-6">--%>
                        <%--<div class="form-group">--%>
                            <%--<label for="birthDate" class="col-sm-4 control-label">生日</label>--%>
                            <%--<div class="col-sm-8">--%>
                                <%--<input type="text" name="birthDate" value="<c:if test="${oprt=='edit'}"><fmt:formatDate value="${bean.birthDate}" pattern="yyyy-MM-dd"/></c:if>" onclick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control ${oprt=='edit' ? 'required' : ''} required" />--%>
                            <%--</div>--%>
                        <%--</div>--%>
                    <%--</div>--%>
                </div>
                <%--身份证--%>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label"><em class="required">*</em>身份证编号</label>
                            <div class="col-sm-8">
                                <f:text id="idcarno" name="idcarno" value="${bean.idcarno}" class="form-control required card" maxlength="100"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label"><em class="required">*</em>工作单位</label>
                            <div class="col-sm-8">
                                <f:text id="idcarno" name="union" value="${bean.union}" class="form-control require" maxlength="100"/>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">职务</label>
                            <div class="col-sm-8">
                                <f:text id="zhiWu" name="zhiWu" value="${bean.zhiWu}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">年龄</label>
                            <div class="col-sm-8">
                                <f:text id="age" name="age" value="${bean.age}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">户籍地址</label>
                            <div class="col-sm-8">
                                <f:text id="huJiDiZhi" name="huJiDiZhi" value="${bean.huJiDiZhi}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">现居地址</label>
                            <div class="col-sm-8">
                                <f:text id="xianjudizhi" name="xianjudizhi" value="${bean.xianjudizhi}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">出生地</label>
                            <div class="col-sm-8">
                                <f:text id="chushengdi" name="chushengdi" value="${bean.chushengdi}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">民族</label>
                            <div class="col-sm-8">
                                <%--<f:text id="minzu" name="minzu" value="${bean.minzu}" class="form-control " maxlength="100"/>--%>
                                <select class="form-control " value="${bean.minzu}" id="minzu" name="minzu">
                                    <option  value="${oprt=='edit' ? (bean.minzu) : ''}">${bean.minzu}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 籍贯 -->
                <div class="row">
                    <div class="col-sm-12">
                        <div class="form-group" data-toggle="distpicker" id="target">
                            <label class="col-sm-2 control-label">籍贯</label>
                            <div class="col-sm-4">
                                <select class="form-control" data-province="${bean.province}" value="${bean.province}" name="province" id="province">

                                </select>
                            </div>
                            <div class="col-sm-4">
                                <select class="form-control" value="${bean.city}" data-city="${bean.city}" name="city" id="city">

                                </select>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">婚姻状况</label>
                            <%--<div class="col-sm-8">--%>
                                <%--<f:text id="hunyingzhuangkuang" name="hunyingzhuangkuang" value="${bean.hunyingzhuangkuang}" class="form-control " maxlength="100"/>--%>
                            <%--</div>--%>

                            <div class="col-sm-8">
                                <select class="form-control" id="hunyingzhuangkuang" name="hunyingzhuangkuang">
                                    <f:option value="已婚" selected="${bean.hunyingzhuangkuang}" default="已婚">已婚</f:option>
                                    <f:option value="未婚" selected="${bean.hunyingzhuangkuang}">未婚</f:option>
                                    <f:option value="离异" selected="${bean.hunyingzhuangkuang}">离异</f:option>
                                    <f:option value="丧偶" selected="${bean.hunyingzhuangkuang}">丧偶</f:option>
                                    <f:option value="其他" selected="${bean.hunyingzhuangkuang}">其他</f:option>
                                </select>
                            </div>


                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">政治面貌</label>
                            <div class="col-sm-8">
                                <%--<f:text id="zhengzhimianmao" name="zhengzhimianmao" value="${bean.zhengzhimianmao}" class="form-control " maxlength="100"/>--%>
                                    <select class="form-control" id="zhengzhimianmao" name="zhengzhimianmao">
                                        <f:option value="中共党员" selected="${bean.zhengzhimianmao}" default="中共党员">中共党员</f:option>
                                        <f:option value="中共预备党员" selected="${bean.zhengzhimianmao}">中共预备党员</f:option>
                                        <f:option value="共青团员" selected="${bean.zhengzhimianmao}">共青团员</f:option>
                                        <f:option value="群众" selected="${bean.zhengzhimianmao}">群众</f:option>
                                        <f:option value="其他" selected="${bean.zhengzhimianmao}">其他</f:option>

                                    </select>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">第一学历</label>
                            <div class="col-sm-8">
                                <f:text id="diyixueli" name="diyixueli" value="${bean.diyixueli}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">第一学历毕业学校</label>
                            <div class="col-sm-8">
                                <f:text id="diyibiyexuexiao" name="diyibiyexuexiao" value="${bean.diyibiyexuexiao}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">第一学历专业</label>
                            <div class="col-sm-8">
                                <f:text id="diyizhuanye" name="diyizhuanye" value="${bean.diyizhuanye}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">最高学历</label>
                            <div class="col-sm-8">
                                <%--<f:text id="zuigaoxueli" name="zuigaoxueli" value="${bean.zuigaoxueli}" class="form-control " maxlength="100"/>--%>
                                    <select class="form-control" id="zuigaoxueli" name="zuigaoxueli">
                                        <f:option value="其他" selected="${bean.zuigaoxueli}" default="其他">其他</f:option>
                                        <f:option value="博士" selected="${bean.zuigaoxueli}">博士</f:option>
                                        <f:option value="研究生" selected="${bean.zuigaoxueli}">研究生</f:option>
                                        <f:option value="本科" selected="${bean.zuigaoxueli}">本科</f:option>
                                        <f:option value="专科" selected="${bean.zuigaoxueli}">专科</f:option>
                                        <f:option value="高中" selected="${bean.zuigaoxueli}">高中</f:option>
                                        <f:option value="初中" selected="${bean.zuigaoxueli}">初中</f:option>
                                        <f:option value="小学" selected="${bean.zuigaoxueli}">小学</f:option>
                                    </select>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">最高学历学习形式</label>
                            <div class="col-sm-8">
                                <%--<f:text id="zuigaoxuelixuexixingcheng" name="zuigaoxuelixuexixingcheng" value="${bean.zuigaoxuelixuexixingcheng}" class="form-control " maxlength="100"/>--%>
                                    <select class="form-control" id="zuigaoxuelixuexixingcheng" name="zuigaoxuelixuexixingcheng">
                                        <f:option value="统招" selected="${bean.zuigaoxuelixuexixingcheng}" default="统招">统招</f:option>
                                        <f:option value="成人高考" selected="${bean.zuigaoxuelixuexixingcheng}">成人高考</f:option>
                                        <f:option value="自考" selected="${bean.zuigaoxuelixuexixingcheng}">自考</f:option>
                                        <f:option value="电大" selected="${bean.zuigaoxuelixuexixingcheng}">电大</f:option>
                                        <f:option value="其他" selected="${bean.zuigaoxuelixuexixingcheng}">其他</f:option>
                                    </select>


                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">最高学历专业</label>
                            <div class="col-sm-8">
                                <f:text id="zuigaoxuelizhuanye" name="zuigaoxuelizhuanye" value="${bean.zuigaoxuelizhuanye}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" style="display: none;">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">专业技术名称</label>
                            <div class="col-sm-8">
                                <f:text id="zuigaozigemincheng" name="zuigaozigemincheng" value="${bean.zuigaozigemincheng}" class="form-control " maxlength="100"/>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">入党日期</label>
                            <div class="col-sm-8">
                                <input type="text" name="rudangriqi"  value="<c:if test="${oprt=='edit'}"><fmt:formatDate value="${bean.rudangriqi}" pattern="yyyy-MM-dd"/></c:if>"onclick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control " />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">参工日期</label>
                            <div class="col-sm-8">
                                <input type="text" name="cangongriqi"  value="<c:if test="${oprt=='edit'}"><fmt:formatDate value="${bean.cangongriqi}" pattern="yyyy-MM-dd"/></c:if>"onclick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control " />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label"><em class="required">*</em>入厂时间</label>
                            <div class="col-sm-8">
                                <input type="text" name="ruchangshijian"  value="<c:if test="${oprt=='edit'}"><fmt:formatDate value="${bean.ruchangshijian}" pattern="yyyy-MM-dd"/></c:if>"onclick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control " />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">第一学历毕业时间</label>
                            <div class="col-sm-8">
                                <input type="text" name="diyibiyeshijan"  value="<c:if test="${oprt=='edit'}"><fmt:formatDate value="${bean.diyibiyeshijan}" pattern="yyyy-MM-dd"/></c:if>"onclick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control " />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">入团时间</label>
                            <div class="col-sm-8">
                                <input type="text" name="rutuanriqi"  value="<c:if test="${oprt=='edit'}"><fmt:formatDate value="${bean.rutuanriqi}" pattern="yyyy-MM-dd"/></c:if>"onclick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control " />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label">最高学历毕业时间</label>
                            <div class="col-sm-8">
                                <input type="text" name="zuigaoxuelibiyeshijian"  value="<c:if test="${oprt=='edit'}"><fmt:formatDate value="${bean.zuigaoxuelibiyeshijian}" pattern="yyyy-MM-dd"/></c:if>"onclick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control " />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qqOpenid" class="col-sm-4 control-label"><s:message code="user.qqOpenid" /></label>
                            <div class="col-sm-8">
                                <f:text class="form-control" id="qqOpenid" name="qqOpenid" value="${bean.qqOpenid}" maxlength="64" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="weiboUid" class="col-sm-4 control-label"><s:message code="user.weiboUid" /></label>
                            <div class="col-sm-8">
                                <f:text class="form-control" id="weiboUid" name="weiboUid" value="${bean.weiboUid}" maxlength="64" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="email" class="col-sm-4 control-label"><s:message code="user.email" /></label>
                            <div class="col-sm-8">
                                <f:text id="email" name="email" value="${bean.email}" class="form-control email" maxlength="100" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="mobile" class="col-sm-4 control-label"><s:message code="user.mobile" /></label>
                            <div class="col-sm-8">
                                <f:text id="mobile" name="mobile" value="${bean.mobile}" class="form-control" maxlength="100" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="comeFrom" class="col-sm-4 control-label"><s:message code="user.comeFrom" /></label>
                            <div class="col-sm-8">
                                <f:text id="comeFrom" name="comeFrom" value="${bean.comeFrom}" class="form-control" maxlength="100" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="weixin" class="col-sm-4 control-label"><s:message code="user.weixin" /></label>
                            <div class="col-sm-8">
                                <f:text id="weixin" name="weixin" value="${bean.weixin}" class="form-control" maxlength="100" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="qq" class="col-sm-4 control-label"><s:message code="user.qq" /></label>
                            <div class="col-sm-8">
                                <f:text id="qq" name="qq" value="${bean.qq}" class="form-control" maxlength="100" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="msn" class="col-sm-4 control-label"><s:message code="user.msn" /></label>
                            <div class="col-sm-8">
                                <f:text id="msn" name="msn" value="${bean.msn}" class="form-control" maxlength="100" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="form-group">
                            <label for="id" class="col-sm-2 control-label"><s:message code="user.bio" /></label>
                            <div class="col-sm-10">
                                <f:textarea class="form-control" id="bio" name="bio" value="${bean.bio}" maxlength="255" rows="3" />
                            </div>
                        </div>
                    </div>
                </div>




                <c:if test="${oprt=='edit'}">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label for="creationDate" class="col-sm-4 control-label"><em class="required">*</em><s:message code="user.creationDate" /></label>
                                <div class="col-sm-8">
                                    <input type="text" id="creationDate" name="creationDate" value="<fmt:formatDate value="${bean.creationDate}" pattern="yyyy-MM-dd'T'HH:mm:ss"/>" onclick="WdatePicker({dateFmt:'yyyy-MM-ddTHH:mm:ss'});" class="form-control required" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label for="creationIp" class="col-sm-4 control-label"><em class="required">*</em><s:message code="user.creationIp" /></label>
                                <div class="col-sm-8">
                                    <f:text id="creationIp" name="creationIp" value="${bean.creationIp}" class="form-control required" maxlength="100" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label for="prevLoginDate" class="col-sm-4 control-label"><s:message code="user.prevLoginDate" /></label>
                                <div class="col-sm-8">
                                    <input type="text" id="prevLoginDate" name="prevLoginDate" class="form-control" value="<fmt:formatDate value="${bean.prevLoginDate}" pattern="yyyy-MM-dd'T'HH:mm:ss"/>" onclick="WdatePicker({dateFmt:'yyyy-MM-ddTHH:mm:ss'});" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label for="prevLoginIp" class="col-sm-4 control-label"><s:message code="user.prevLoginIp" /></label>
                                <div class="col-sm-8">
                                    <f:text id="prevLoginIp" name="prevLoginIp" value="${bean.prevLoginIp}" class="form-control" maxlength="100" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label for="logins" class="col-sm-2 control-label"><s:message code="user.logins" /></label>
                                <div class="col-sm-10">
                                    <f:text id="logins" name="logins" value="${bean.logins}" class="form-control digits" maxlength="10" />
                                </div>
                            </div>
                        </div>
                    </div>
                </c:if>

                <c:set var="colCount" value="${0}" />
                <c:forEach var="field" items="${model.enabledFields}">

                    <c:if test="${colCount%2==0||!field.dblColumn}">
                        <div class="row">
                    </c:if>
                    <div class="col-sm-${field.dblColumn?'6':'12'}">
                        <div class="form-group">
                            <label class="col-sm-${field.dblColumn?'4':'2'} control-label"><c:if test="${field.required}"><em class="required">*</em></c:if><c:out value="${field.label}" /></label>
                            <div class="col-sm-${field.dblColumn?'8':'10'}">
                                <c:choose>
                                    <c:when test="${field.custom}">
                                        <tags:feild_custom bean="${bean}" field="${field}" />
                                    </c:when>
                                    <c:otherwise>

                                    </c:otherwise>
                                </c:choose>
                            </div>
                        </div>
                    </div>
                    <c:if test="${colCount%2==1||!field.dblColumn}">
                        </div>
                    </c:if>
                    <c:if test="${field.dblColumn}"><c:set var="colCount" value="${colCount+1}" /></c:if>
                </c:forEach>

            </div>
            <div class="box-footer">
                <button class="btn btn-primary" type="submit"><s:message code="save" /></button>
                <button class="btn btn-default" type="submit" onclick="$('#redirect').val('list');"><s:message code="saveAndReturn" /></button>
                <c:if test="${oprt=='create'}">
                    <button class="btn btn-default" type="submit" onclick="$('#redirect').val('create');"><s:message code="saveAndCreate" /></button>
                </c:if>
            </div>
        </form>
    </div>
</div>
</body>
<c:if test="${oprt=='edit'}">
<script type="text/javascript">
function selectImg(){
    document.getElementById("uploadImg").click()
}
function handleImg(){
 
            //将用户选择的文件追加到formData表单对象中
            // var file = document.getElementById('uploadImg').files[0]
            // var formData = new FormData();
            // formData.append("file", file);
			// var userid = document.getElementById('userid').value
			// $.ajax({
			// 	url: '${ctx}/my/5706_avatar_upload',
			// 	cache: false,
			// 	type: "POST",
			// 	processData: false, // 告诉jQuery不要去处理发送的数据
			// 	contentType: false, // 告诉jQuery不要去设置Content-Type请求头

			// 	//传送请求数据
			// 	data: {
			// 		file:formData,
			// 		userid:userid
			// 	},
			// 	success: function(data) {
			// 		if (data === 'login') {
			// 			alert("请登录后再操作！谢谢");
			// 			window.location.href = '${ctx}/login?fallbackUrl=${url}';
			// 		} else {
			// 			alert("修改成功！");
			// 			//location.reload();
			// 		}
			// 	}
			// })
            document.getElementById("imgBtn").click()
}
function saveImg(){
            //将用户选择的文件追加到formData表单对象中
            var formData = new FormData($('#userImage')[0])
			var userid = document.getElementById('userid').value
            formData.append('userid',userid)
            console.log($('#userImage')[0])
            for (var [a, b] of formData.entries()) {
                console.log(a, b);
            } 
			$.ajax({
				url: '${ctx}/my/5706_avatar_upload',
				cache: false,
				type: "POST",
				processData: false, // 告诉jQuery不要去处理发送的数据
				contentType: false, // 告诉jQuery不要去设置Content-Type请求头

				//传送请求数据
				data: formData,
				success: function(data) {
					if (data === 'login') {
						alert("请登录后再操作！谢谢");
						window.location.href = '${ctx}/login?fallbackUrl=${url}';
					} else {
						alert("修改成功！");
						//location.reload();
                        var data=JSON.parse(data)
                        console.log(data)
                        console.log(data.fileUrl)
                        document.getElementById('headImg').src=data.fileUrl
					}
				}
			})
}

</script>
</c:if>
</html>